                     远程注册控件TeleReg Ocx 2.0
                     ~~~~~~~~~~~~~~~~~~~~~~~~~~
版本 2.0
开发者：赵建立
作者: http://danlihua.yeah.net
产品：http://www.telereg.com
Email: jianli.zhao@990.net
★免费软件，您可以随意Copy，加入你的应用程序中发行、传播。

------------------------------------------------------------------
★这是一个用于保护软件不被盗版，可以实现软件远程注册的控件。
  在这个版本中，新增加了注册码软盘急救，开发者Web、E-Mail技术支持、
  除可限定试用截止日期外，还增加了软件试用天数、次数、和分钟数限制。
  开发者可自由选择上述限制，并能根据需要设定上述限制的与(and)或(or)关系。
----------------------------------------------------------------
★使用方法：
   将TeleReg.ocx;RegKey.ocx拷入你的Windows的system目录
   在运行窗口执行：Regsvr32 TeleReg.ocx
                   Regsvr32 RegKey.ocx
   再在VB5中加入此控件，即可使用。

★    盗版、注册机的克星     ----介绍TeleReg控件
     “盗版“已成为制约我国软件业发展的最大挡路虎。巨额投资开发的软件被盗版者轻
易掠走，软件企业谈何发展。为抵制盗版软件，加密工作被越来越多的软件厂商所重视。
然而，传统的注册号很容易被不法商贩滥用，采用硬件加密狗又会显著增加成本，而且使
用不便。本文介绍的一种ActiveX控件(即 OLE控件)---自动远程注册(TeleReg)控件，作为
一种抑制盗版的有力武器，很容易嵌入你的软件中，能够自动识别用户，并可实现远程注册，
可有效地抵制“盗版”。

               一 　TeleReg控件的功能特点
    我们知道，所谓ActiveX控件(OLE控件)是Microsoft倡导的一种基于部件的软件开
发技术，这里所说的TeleReg控件就是这样一种ActiveX控件，它可以方便地加入到你开发
的应用程序中去，使应用程序具有该控件的特点，实现远程注册、自动跟踪设置等功能。
　　１、远程注册。
　　现在软件发布时，一般都随盘给用户一个注册号，用户凭此注册号输入注册信息，程序
就可正常使用，而这个注册号相对稳定，正版用户一张盘可安装多台计算机，盗版者更可复
制注册号,因此这种注册方式作用甚微。
    这里所谓自动远程注册，就是指应用程序被安装到用户计算机上，用户启动应用程序时，
TeleReg控件能自动检测用户的计算机软硬件环境状态，并依此自动给出用户号，要求用户
注册，用户凭此用户号寄付适当注册费用，便可以向开发者索取注册号。只有输入注册号后，
程序才可正常使用。该注册号与用户号一一对应，其它计算机因用户号不同,输入此注册号
则不被确认，这样就可以实现软件的远程注册。
    ２、动态跟踪。
　　我们知道，用户计算机的应用环境并不是一成不变的，如果由于用户计算机的环境改变，
就无法使用已注册的软件，那么这种软件有谁会喜欢呢？考虑到这一点，TeleReg控件设置
了动态跟踪功能。
　　所谓动态跟踪，就是说当注册用户的计算机环境改变时，TeleReg控件能自动跟踪检测
用户的计算机环境变化，当检测到环境变化时能自动适应环境变化。这些都在后台执行，
不干扰用户操作。
　　３、恢复注册。
　　最坏的情况，当用户操作失误，系统注册表遗失时，还可以人工恢复注册表。
　　注册表遗失后，TeleReg会主动提出要求用户注册。但此时可能由于系统环境改变，
用户号也会改变，简单输入原来的注册号一般不会被确认，这时，用户需要双击用户号文本，
TeleReg的用户号会变成输入文本框，在此输入申请注册号时的用户号，然后输入注册号，
可以得到重新注册确认。当用户收到注册号时如用户号已改变也可通过上述方式注册。
　　你也许会说，其它用户是否也能用输入用户号、注册号的方式得到确认呢？不会的，因
为用户号包含了用户计算机系统的环境信息，恢复注册时采用模糊处理技术，能自动识别用
户信息。但是如果用户系统彻底改变，无法识别确认时，恢复注册会失败。
    为了方便恢复注册，在2.0版新增加了注册急救盘功能，用户注册后，控件会提示用户
创建注册急救盘，系统改变（如重装操作系统等）后，可通过双击注册文本框用注册急救盘
恢复注册。
　　４、限制试用    
　　可以通过设置限制试用日期的方式，或限制试用天数、次数、分钟数等，达到让未
注册用户试用，以了解程序功能的目的。开发者可自由选择上述限制，并能根据需要设定
上述限制的与（and)或(or)关系。
　　限制试用过期后引发NoFree事件，开发者可在NoFree 事件中加入代码终止程序运行。
　　　　　　　二、控件的属性和事件
　　１、属性
　　TeleReg控件的重要属性放置在数据分类中，并可通过自定义属性页的方式设置属
性。在数据分类中有AppCode、AppName、FreeDate、FreeDay、Freetimes、FreeMinute、
User、Andor、等属性：
    AppCode是用来加密注册密码的最重要属性，该属性为９位数字，可随机取一个值，
一定要注意保密。
    AppName属性为String字符串，一般在此输入应用程序名，用户申请注册号时附加
在用户号前，开发者可用来识别应用程序以便发放注册号。
    FreeDate属性用来设定未注册用户可以试用的截止日期。
    FreeDay属性用来设定未注册用户可试用的天数，FreeTimes属性用来设定未注册用
户可试用的次数。
    FreeMinute属性用来设定未注册用户可试用的时间（单位分钟）。
    Andor属性决定试用条件的与（and)或(or)关系。
    User属性可以返回一个布尔值，反映用户是否注册信息，应用程序调用此属性，可
判别用户是否注册，然后决定程序走向。
　　TeleReg控件的界面和运行期间的交互文本都以属性的形式提供给开发者，开发人员可
以修改这些文本，这些文本都放在属性窗口的文本分类中，在自定义属性页中这些文本被分
成了界面文本和对话文本两项。
    在文本属性中RegWeb属性可加入开发者主页如：http://www.telereg.com，或电子
信箱如：mailto:jianli.zhao@990.net，用于技术支持。
　　TeleReg控件还提供了Font（字体）属性，可用来设置控件上界面文本的字体和大小。
Backcolor、Forecolor属性分别被用来设置背景和字体颜色。
　　２、事件　
　　　　除一般控件的共有事件外，TeleReg控件还提供6个自己的用户响应事件，它们是：　　
     (1) Usertrue事件。当TeleReg检测到用户已注册信息时发生该事件，注册用户每次启
动应用程序都发生该事件，开发人员可在该事件中加入程序运行所必须的代码变量。
　　 (2) Usefalse事件。当TeleReg控件检测到用户未注册信息时发生该事件，未注册
用户每次启动应用程序时都会发生该事件，开发人员可在该事件中加入对未注册用户的
限制等信息代码。
　　 (3) OKClick事件。当用户单击现在注册按钮时发生该事件，该事件过程说明用户
正在尝试注册。
　　 (4) CancelClick事件。当用户单击以后注册按钮或技术支持按扭时发生该事件，
该事件说明用户不想现在注册。
     (5) free事件。用户试用期间每次启动应用程序发生该事件。在该事件中加入试用
期的程序数据。
　　 (6) Nofree事件。当超过试用期时发生该事件。可在此事件中加入中止程序运行
的代码。
　　　　　　　　　三、控件应用实例　
　　为了说明自动注册控件的使用，现结合一个实例说明如下。
　　在应用程序主窗体上放置一个Frame1框作为注册框，在注册框上放置TeleReg控件，用
鼠标可调整TeleReg控件为适当大小，TeleReg控件放置到你的窗体上时即处于运行状态，
它会自动检测你的计算机环境信息并标出用户号，这时，由于你还没有注册，又会出现提示
注册对话框，这和使用TeleReg控件的应用程序在用户计算机上启动时的情况相似，你暂
可单击确定退出提示框，然后根据需要设置Font属性，调整字体大小，设置Forecolor和
Backcolor属性，使TeleReg控件与用户界面协调一致。
　　打开自定义属性页窗口，设置数据属性框，Appcode属性初始值为123456789，可设为
314159265，设置Caption属性为应用程序标题Demo，FreeDate设置为00-6-30，FreeTimes
属性设为1000次。
　　文本属性不做改动，然后在TeleReg的事件中加入代码。
  
       Private Sub TeleReg1_CancelClick()
         Dim Msgok
           Msgok = MsgBox ("你还没有注册，你想以后再注册？" , _
                  vbQuestion , "以后注册？" )
           Frame1.Visible = False
       End Sub

       Private Sub TeleReg1_Userfalse()
             Frame1.Visible = True
       End Sub

       Private Sub TeleReg1_Usertrue()
            Dim Msgok
           Msgok = MsgBox ("恭喜你注册成功，欢迎使用正版软件！" , _
                   vbMsgok , "注册成功" )
           Frame1.Visible = False
       End Sub

       Private Sub TeleReg1_Nofree()
            End
       End Sub
    当你在应用程序中加入TeleReg控件时会出现的请注册对话框，因为你的计算机中还没有
使用TeleReg控件的注册信息，你可通过注册号分配器得到注册号后加入该注册信息，并且通
过注册号分配器给你的用户发放注册号。
　　注册号分配器相当于一个配钥匙的机器，通过它来为你的用户发放注册号，(前提是你要
知道应用程序的密码，你自己设定的当然知道了^=^)
    注册号分配器应用了RegKey控件。RegKey控件是配合TeleReg控件开发的计算注册号的控件
该控件为共享软件，也使用了TeleReg控件技术，注册前为学习版不可更改程序号(只能使用默认值
１２３４５６７８９），注册后才可正常使用，如果想用TeleReg控件发行应用程序，请把你的
RegKey控件注册号寄来，同时寄上注册费 18元，你可收到注册号成为标准版注册用户，
注册后不仅可以修改程序号，还可以用RegKey控件设计更适合你应用的注册号分配器。企业
用户寄上198元，可收到为你定做的企业版。企业版可得到增强功能，其他用户即使知道程序
号也不能得出正确注册号。
　　TeleReg控件没有任何功能限制，可随你的应用程序自由发行使用，因为这是你的应用程序
的锁，你可自由发放给你的用户，你的用户通过你来注册，前提是你要有注册后的注册号分配
器，这相当于给你的程序加了一把免费的锁，但你要购买一个配钥匙机器。
   从前面的介绍可以看出，TeleReg控件作为一种基于部件的软件注册加密工具，可以方便
地为应用程序加入自动注册功能。这样，开发者在开发应用程序时，可用共享版的形式，以
拷贝价格出售软件产品，然后通过远程注册方式获取收益。由开发者直接向用户收取注册费
用，可以大大减少软件的销售成本。这样就极大地限制了盗版者的获利空间，让盗版者无利
可图，自然也就抑制了盗版，促进软件业的健康发展。
    欢迎使用TeleReg控件！
    
    作者：赵建利     
    E-Mail: zjl@sajs.com
★有问题请给我发个伊妹儿。

